<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ìŠ¤ë§ˆíŠ¸ ê¸‰ìˆ˜ ì‹œìŠ¤í…œ</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      text-align: center;
      background: #f1f1f1;
      padding: 2rem;
    }
    .card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      padding: 1.5rem;
      margin: 1rem auto;
      max-width: 400px;
    }
    h2 { margin-bottom: 0.5rem; }
    .sensor { font-size: 1.2rem; margin: 0.3rem 0; }
    button {
      background: #007bff;
      color: white;
      border: none;
      padding: 0.6rem 1.2rem;
      margin-top: 1rem;
      font-size: 1rem;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover { background: #0056b3; }
  </style>
</head>
<body>

  <div class="card">
    <h2>ğŸŒ± ìŠ¤ë§ˆíŠ¸ ê¸‰ìˆ˜ ì‹œìŠ¤í…œ</h2>
    <div class="sensor" id="temp">ì˜¨ë„: -- â„ƒ</div>
    <div class="sensor" id="humi">ìŠµë„: -- %</div>
    <div class="sensor" id="moist">í† ì–‘ ìˆ˜ë¶„: --</div>
    <div class="sensor" id="state">íŒí”„ ìƒíƒœ: --</div>
    <div class="sensor" id="mode">ëª¨ë“œ: --</div>
    <div class="sensor" id="runtime">ê°€ë™ì‹œê°„: --ì´ˆ</div>
    <div class="sensor" id="time">ì—…ë°ì´íŠ¸: --</div>
    <button onclick="toggleMode()">ëª¨ë“œ ì „í™˜</button>
  </div>

  <script>
    // Firebase ì„¤ì •
    const firebaseConfig = {
      apiKey: "AIzaSyAeHP9-GL_uC4c7i9d1R0QCgd99NdzKWD0",
      authDomain: "exwater01.firebaseapp.com",
      databaseURL: "https://exwater01-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "exwater01",
      storageBucket: "exwater01.appspot.com",
      messagingSenderId: "YOUR_ID",
      appId: "YOUR_APP_ID"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const el = id => document.getElementById(id);

    function updateUI(snapshot) {
      const s = snapshot.val();
      if (!s) return;

      el("temp").innerText = `ì˜¨ë„: ${s.sensor?.temperature ?? '--'} â„ƒ`;
      el("humi").innerText = `ìŠµë„: ${s.sensor?.humidity ?? '--'} %`;
      el("moist").innerText = `í† ì–‘ ìˆ˜ë¶„: ${s.sensor?.moisture ?? '--'}`;
      el("state").innerText = `íŒí”„ ìƒíƒœ: ${s.PUMP?.STATE ? 'ON ğŸ’§' : 'OFF'}`;
      el("mode").innerText = `ëª¨ë“œ: ${s.PUMP?.MODE ?? '--'}`;
      el("runtime").innerText = `ê°€ë™ì‹œê°„: ${s.PUMP?.runtime ?? '--'}ì´ˆ`;
      el("time").innerText = `ì—…ë°ì´íŠ¸: ${s.PUMP?.time ?? '--'}`;
    }

    db.ref().on("value", updateUI);

    function toggleMode() {
      db.ref("/PUMP/MODE").once("value").then(snapshot => {
        const current = snapshot.val();
        const next = current === "auto" ? "manual" : "auto";
        db.ref("/PUMP/MODE").set(next);
      });
    }
  </script>

</body>
</html>
